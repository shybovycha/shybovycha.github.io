<meta name="layout" content="post">
<meta name="title" content="Gantt chart with D3.js">
<meta name="date" content="2017-04-09T11:04:24+02:00">
<p>At work, I&#39;ve had a task to implement a Gantt chart diagram to show dependencies and order of some... let&#39;s say, milestones.
Given this feature is in a very unstable beta in Google Charts, I thought to myself: <em>&quot;Why don&#39;t I implement it on my own?&quot;</em>.
And tried to recall my D3 knowledge.</p>

<p>I&#39;ve also found a minimalistic, but helpful example / screenshot of some Gantt chart implementation:</p>

<p><img data-src="/images/gantt_chart_with_d3/gantt-sample_optimized.png" alt=""></p>

<p>The challenges I&#39;ve faced were:</p>

<ol>
<li>order milestones on a timeline</li>
<li>scale milestones to fit in a viewport</li>
<li>create pretty connection lines</li>
<li>center text inside each milestone</li>
</ol>

<p>And since D3 is a data-driven library, I&#39;ve used map/reduce where possible.</p>

<p>Here&#39;s how the result looked like:</p>

<p><img data-src="/images/gantt_chart_with_d3/d3-gantt-chart_optimized.png" alt=""></p>

<p>The full implementation code is under the cut.</p>

<!--more-->

<p>I hope the implementation is more or less clear, but here are some details: the algorithm consists of three main parts - initial data pre-processing - (parsing and validating dates, calculating the default values and so on); calculating the graphics params (positions, sizes) and finally, rendering that into SVG.</p>

<p>I&#39;ve tried using caches whenever possible to optimize the performance and save some calculation time by just creating maps <code>id -&gt; object</code>, since the algorithm refers to objects by their IDs a lot (like getting all the children of an element or getting a particular child&#39;s data).</p>

<p>The data pre-processing is basically computing the length of each element based on either <code>startDate</code> and <code>endDate</code> or <code>startDate</code> and <code>duration</code>. Adding the <code>endDate</code> and <code>duration</code> option is possible and trivial, but I thought this is a less useful feature.</p>

<p>The transformation of data is the most interesting part - we need to calculate the positions of each element on a &quot;screen&quot;, and it heavily relies on data sorting mode - if we need to sort the data by the amount of children - this is somewhat simple. But if we sort data by dates - we need to count for element&#39;s index in the overall list of elements.</p>

<p>Then we calculate the parameters of connection lines. They might be redundant for some users, but in my case it was essential to show the dependencies between elements sorted by children count. This is less trivial, since one needs to find the bends of each line. Hence I decided to simplify this problem by putting all the lines <em>under</em> the rectangles and assuming every line consists of these sections:</p>

<ol>
<li>the &quot;input&quot; and &quot;output&quot; pins (near the <code>endDate</code> end of a parent element and near <code>startDate</code> end of children element)</li>
<li>two vertical sections to reach the height of a children element</li>
<li>a connection between the lines from p. 2</li>
</ol>

<p>The last piece of an algorithm is generating SVG. This is where D3 strikes in and, given all the params generated in the previous section, creates SVG elements in DOM tree and scales them considering <code>svgOptions</code> passed to the main function.</p>

<p>The implementation is below and the live demo is <a href="https://codepen.io/shybovycha/pen/vxdePv">here</a></p>
<span class="kd">const</span> <span class="nx">prepareDataElement</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">label</span><span class="p">,</span> <span class="nx">startDate</span><span class="p">,</span> <span class="nx">endDate</span><span class="p">,</span> <span class="nx">duration</span><span class="p">,</span> <span class="nx">dependsOn</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nx">startDate</span> <span class="o">||</span> <span class="o">!</span><span class="nx">endDate</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">duration</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="dl">'</span><span class="s1">Wrong element format: should contain either startDate and duration, or endDate and duration or startDate and endDate</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">startDate</span><span class="p">)</span> <span class="nx">startDate</span> <span class="o">=</span> <span class="nx">moment</span><span class="p">(</span><span class="nx">startDate</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">endDate</span><span class="p">)</span> <span class="nx">endDate</span> <span class="o">=</span> <span class="nx">moment</span><span class="p">(</span><span class="nx">endDate</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">startDate</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">endDate</span> <span class="o">&amp;&amp;</span> <span class="nx">duration</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">endDate</span> <span class="o">=</span> <span class="nx">moment</span><span class="p">(</span><span class="nx">startDate</span><span class="p">);</span>
    <span class="nx">endDate</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">duration</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">duration</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">startDate</span> <span class="o">&amp;&amp;</span> <span class="nx">endDate</span> <span class="o">&amp;&amp;</span> <span class="nx">duration</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">startDate</span> <span class="o">=</span> <span class="nx">moment</span><span class="p">(</span><span class="nx">endDate</span><span class="p">);</span>
    <span class="nx">startDate</span><span class="p">.</span><span class="nx">subtract</span><span class="p">(</span><span class="nx">duration</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">duration</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">dependsOn</span><span class="p">)</span>
    <span class="nx">dependsOn</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">id</span><span class="p">,</span>
    <span class="nx">label</span><span class="p">,</span>
    <span class="nx">startDate</span><span class="p">,</span>
    <span class="nx">endDate</span><span class="p">,</span>
    <span class="nx">duration</span><span class="p">,</span>
    <span class="nx">dependsOn</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">findDateBoundaries</span> <span class="o">=</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">minStartDate</span><span class="p">,</span> <span class="nx">maxEndDate</span><span class="p">;</span>

  <span class="nx">data</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(({</span> <span class="nx">startDate</span><span class="p">,</span> <span class="nx">endDate</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">minStartDate</span> <span class="o">||</span> <span class="nx">startDate</span><span class="p">.</span><span class="nx">isBefore</span><span class="p">(</span><span class="nx">minStartDate</span><span class="p">))</span> <span class="nx">minStartDate</span> <span class="o">=</span> <span class="nx">moment</span><span class="p">(</span><span class="nx">startDate</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">minStartDate</span> <span class="o">||</span> <span class="nx">endDate</span><span class="p">.</span><span class="nx">isBefore</span><span class="p">(</span><span class="nx">minStartDate</span><span class="p">))</span> <span class="nx">minStartDate</span> <span class="o">=</span> <span class="nx">moment</span><span class="p">(</span><span class="nx">endDate</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">maxEndDate</span> <span class="o">||</span> <span class="nx">endDate</span><span class="p">.</span><span class="nx">isAfter</span><span class="p">(</span><span class="nx">maxEndDate</span><span class="p">))</span> <span class="nx">maxEndDate</span> <span class="o">=</span> <span class="nx">moment</span><span class="p">(</span><span class="nx">endDate</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">maxEndDate</span> <span class="o">||</span> <span class="nx">startDate</span><span class="p">.</span><span class="nx">isAfter</span><span class="p">(</span><span class="nx">maxEndDate</span><span class="p">))</span> <span class="nx">maxEndDate</span> <span class="o">=</span> <span class="nx">moment</span><span class="p">(</span><span class="nx">startDate</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">minStartDate</span><span class="p">,</span>
    <span class="nx">maxEndDate</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">createDataCacheById</span> <span class="o">=</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">cache</span><span class="p">,</span> <span class="nx">elt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">cache</span><span class="p">,</span> <span class="p">{</span> <span class="p">[</span><span class="nx">elt</span><span class="p">.</span><span class="nx">id</span><span class="p">]:</span> <span class="nx">elt</span> <span class="p">}),</span> <span class="p">{});</span>

<span class="kd">const</span> <span class="nx">createChildrenCache</span> <span class="o">=</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">dataCache</span> <span class="o">=</span> <span class="nx">createDataCacheById</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">fillDependenciesForElement</span> <span class="o">=</span> <span class="p">(</span><span class="nx">eltId</span><span class="p">,</span> <span class="nx">dependenciesByParent</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">dataCache</span><span class="p">[</span><span class="nx">eltId</span><span class="p">].</span><span class="nx">dependsOn</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">parentId</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">dependenciesByParent</span><span class="p">[</span><span class="nx">parentId</span><span class="p">])</span>
        <span class="nx">dependenciesByParent</span><span class="p">[</span><span class="nx">parentId</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">dependenciesByParent</span><span class="p">[</span><span class="nx">parentId</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">eltId</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nx">dependenciesByParent</span><span class="p">[</span><span class="nx">parentId</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">eltId</span><span class="p">);</span>

      <span class="nx">fillDependenciesForElement</span><span class="p">(</span><span class="nx">parentId</span><span class="p">,</span> <span class="nx">dependenciesByParent</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="nx">data</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">cache</span><span class="p">,</span> <span class="nx">elt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">cache</span><span class="p">[</span><span class="nx">elt</span><span class="p">.</span><span class="nx">id</span><span class="p">])</span>
      <span class="nx">cache</span><span class="p">[</span><span class="nx">elt</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="nx">fillDependenciesForElement</span><span class="p">(</span><span class="nx">elt</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">cache</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">cache</span><span class="p">;</span>
  <span class="p">},</span> <span class="p">{});</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">sortElementsByChildrenCount</span> <span class="o">=</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">childrenByParentId</span> <span class="o">=</span> <span class="nx">createChildrenCache</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

  <span class="k">return</span> <span class="nx">data</span><span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">e1</span><span class="p">,</span> <span class="nx">e2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">childrenByParentId</span><span class="p">[</span><span class="nx">e1</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">childrenByParentId</span><span class="p">[</span><span class="nx">e2</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">childrenByParentId</span><span class="p">[</span><span class="nx">e1</span><span class="p">.</span><span class="nx">id</span><span class="p">].</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">childrenByParentId</span><span class="p">[</span><span class="nx">e2</span><span class="p">.</span><span class="nx">id</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span>
      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">sortElementsByEndDate</span> <span class="o">=</span> <span class="nx">data</span> <span class="o">=&gt;</span>
  <span class="nx">data</span><span class="p">.</span><span class="nx">sort</span><span class="p">((</span><span class="nx">e1</span><span class="p">,</span> <span class="nx">e2</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">moment</span><span class="p">(</span><span class="nx">e1</span><span class="p">.</span><span class="nx">endDate</span><span class="p">).</span><span class="nx">isBefore</span><span class="p">(</span><span class="nx">moment</span><span class="p">(</span><span class="nx">e2</span><span class="p">.</span><span class="nx">endDate</span><span class="p">)))</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span>
      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">});</span>

<span class="kd">const</span> <span class="nx">sortElements</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">sortMode</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">sortMode</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">childrenCount</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">sortElementsByChildrenCount</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">sortMode</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">date</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">sortElementsByEndDate</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">parseUserData</span> <span class="o">=</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">prepareDataElement</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">createPolylineData</span> <span class="o">=</span> <span class="p">(</span><span class="nx">rectangleData</span><span class="p">,</span> <span class="nx">elementHeight</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// prepare dependencies polyline data</span>
  <span class="kd">const</span> <span class="nx">cachedData</span> <span class="o">=</span> <span class="nx">createDataCacheById</span><span class="p">(</span><span class="nx">rectangleData</span><span class="p">);</span>

  <span class="c1">// used to calculate offsets between elements later</span>
  <span class="kd">const</span> <span class="nx">storedConnections</span> <span class="o">=</span> <span class="nx">rectangleData</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span> <span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">acc</span><span class="p">,</span> <span class="p">{</span> <span class="p">[</span><span class="nx">e</span><span class="p">.</span><span class="nx">id</span><span class="p">]:</span> <span class="mi">0</span> <span class="p">}),</span> <span class="p">{});</span>

  <span class="c1">// create data describing connections' lines</span>
  <span class="k">return</span> <span class="nx">rectangleData</span><span class="p">.</span><span class="nx">flatMap</span><span class="p">(</span><span class="nx">d</span> <span class="o">=&gt;</span>
    <span class="nx">d</span><span class="p">.</span><span class="nx">dependsOn</span>
      <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">parentId</span> <span class="o">=&gt;</span> <span class="nx">cachedData</span><span class="p">[</span><span class="nx">parentId</span><span class="p">])</span>
      <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">parent</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">color</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">#</span><span class="dl">'</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()))</span> <span class="o">*</span> <span class="mh">0xFFF</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>

        <span class="c1">// increase the amount rows occupied by both parent and current element (d)</span>
        <span class="nx">storedConnections</span><span class="p">[</span><span class="nx">parent</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
        <span class="nx">storedConnections</span><span class="p">[</span><span class="nx">d</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>

        <span class="kd">const</span> <span class="nx">deltaParentConnections</span> <span class="o">=</span> <span class="nx">storedConnections</span><span class="p">[</span><span class="nx">parent</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nx">elementHeight</span> <span class="o">/</span> <span class="mi">4</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">deltaChildConnections</span> <span class="o">=</span> <span class="nx">storedConnections</span><span class="p">[</span><span class="nx">d</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nx">elementHeight</span> <span class="o">/</span> <span class="mi">4</span><span class="p">);</span>

        <span class="kd">const</span> <span class="nx">points</span> <span class="o">=</span> <span class="p">[</span>
          <span class="nx">d</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="p">(</span><span class="nx">elementHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
          <span class="nx">d</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">deltaChildConnections</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="p">(</span><span class="nx">elementHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
          <span class="nx">d</span><span class="p">.</span><span class="nx">x</span> <span class="o">-</span> <span class="nx">deltaChildConnections</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="p">(</span><span class="nx">elementHeight</span> <span class="o">*</span> <span class="mf">0.25</span><span class="p">)),</span>
          <span class="nx">parent</span><span class="p">.</span><span class="nx">xEnd</span> <span class="o">+</span> <span class="nx">deltaParentConnections</span><span class="p">,</span> <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">y</span> <span class="o">-</span> <span class="p">(</span><span class="nx">elementHeight</span> <span class="o">*</span> <span class="mf">0.25</span><span class="p">)),</span>
          <span class="nx">parent</span><span class="p">.</span><span class="nx">xEnd</span> <span class="o">+</span> <span class="nx">deltaParentConnections</span><span class="p">,</span> <span class="p">(</span><span class="nx">parent</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="p">(</span><span class="nx">elementHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span>
          <span class="nx">parent</span><span class="p">.</span><span class="nx">xEnd</span><span class="p">,</span> <span class="p">(</span><span class="nx">parent</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="p">(</span><span class="nx">elementHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
        <span class="p">];</span>

        <span class="k">return</span> <span class="p">{</span>
          <span class="na">points</span><span class="p">:</span> <span class="nx">points</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="p">),</span>
          <span class="nx">color</span>
        <span class="p">};</span>
      <span class="p">})</span>
  <span class="p">);</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">createElementData</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">elementHeight</span><span class="p">,</span> <span class="nx">xScale</span><span class="p">,</span> <span class="nx">fontSize</span><span class="p">)</span> <span class="o">=&gt;</span>
  <span class="nx">data</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">d</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">startDate</span><span class="p">.</span><span class="nx">toDate</span><span class="p">());</span>
    <span class="kd">const</span> <span class="nx">xEnd</span> <span class="o">=</span> <span class="nx">xScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">endDate</span><span class="p">.</span><span class="nx">toDate</span><span class="p">());</span>
    <span class="kd">const</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">*</span> <span class="nx">elementHeight</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">width</span> <span class="o">=</span> <span class="nx">xEnd</span> <span class="o">-</span> <span class="nx">x</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">height</span> <span class="o">=</span> <span class="nx">elementHeight</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">charWidth</span> <span class="o">=</span> <span class="p">(</span><span class="nx">width</span> <span class="o">/</span> <span class="nx">fontSize</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">dependsOn</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">dependsOn</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">tooltip</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">label</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">singleCharWidth</span> <span class="o">=</span> <span class="nx">fontSize</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">singleCharHeight</span> <span class="o">=</span> <span class="nx">fontSize</span> <span class="o">*</span> <span class="mf">0.45</span><span class="p">;</span>

    <span class="kd">let</span> <span class="nx">label</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">label</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">label</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">charWidth</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">label</span> <span class="o">=</span> <span class="nx">label</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">''</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">charWidth</span> <span class="o">-</span> <span class="mi">3</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="dl">''</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">...</span><span class="dl">'</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">labelX</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="p">((</span><span class="nx">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="nx">label</span><span class="p">.</span><span class="nx">length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="nx">singleCharWidth</span><span class="p">));</span>
    <span class="kd">const</span> <span class="nx">labelY</span> <span class="o">=</span> <span class="nx">y</span> <span class="o">+</span> <span class="p">((</span><span class="nx">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">singleCharHeight</span><span class="p">));</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">x</span><span class="p">,</span>
      <span class="nx">y</span><span class="p">,</span>
      <span class="nx">xEnd</span><span class="p">,</span>
      <span class="nx">width</span><span class="p">,</span>
      <span class="nx">height</span><span class="p">,</span>
      <span class="nx">id</span><span class="p">,</span>
      <span class="nx">dependsOn</span><span class="p">,</span>
      <span class="nx">label</span><span class="p">,</span>
      <span class="nx">labelX</span><span class="p">,</span>
      <span class="nx">labelY</span><span class="p">,</span>
      <span class="nx">tooltip</span>
    <span class="p">};</span>
  <span class="p">});</span>

<span class="kd">const</span> <span class="nx">createChartSVG</span> <span class="o">=</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">placeholder</span><span class="p">,</span> <span class="p">{</span> <span class="nx">svgWidth</span><span class="p">,</span> <span class="nx">svgHeight</span><span class="p">,</span> <span class="nx">elementHeight</span><span class="p">,</span> <span class="nx">scaleWidth</span><span class="p">,</span> <span class="nx">scaleHeight</span><span class="p">,</span> <span class="nx">fontSize</span><span class="p">,</span> <span class="nx">minStartDate</span><span class="p">,</span> <span class="nx">maxEndDate</span><span class="p">,</span> <span class="nx">margin</span><span class="p">,</span> <span class="nx">showRelations</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// create container element for the whole chart</span>
  <span class="kd">const</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">placeholder</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">svg</span><span class="dl">'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">width</span><span class="dl">'</span><span class="p">,</span> <span class="nx">svgWidth</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">height</span><span class="dl">'</span><span class="p">,</span> <span class="nx">svgHeight</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">xScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scaleTime</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="nx">minStartDate</span><span class="p">.</span><span class="nx">toDate</span><span class="p">(),</span> <span class="nx">maxEndDate</span><span class="p">.</span><span class="nx">toDate</span><span class="p">()])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nx">scaleWidth</span><span class="p">]);</span>

  <span class="c1">// prepare data for every data element</span>
  <span class="kd">const</span> <span class="nx">rectangleData</span> <span class="o">=</span> <span class="nx">createElementData</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">elementHeight</span><span class="p">,</span> <span class="nx">xScale</span><span class="p">,</span> <span class="nx">fontSize</span><span class="p">);</span>

  <span class="c1">// create data describing connections' lines</span>
  <span class="kd">const</span> <span class="nx">polylineData</span> <span class="o">=</span> <span class="nx">createPolylineData</span><span class="p">(</span><span class="nx">rectangleData</span><span class="p">,</span> <span class="nx">elementHeight</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">xAxis</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">axisBottom</span><span class="p">(</span><span class="nx">xScale</span><span class="p">);</span>

  <span class="c1">// create container for the data</span>
  <span class="kd">const</span> <span class="nx">g1</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">g</span><span class="dl">'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">transform</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`translate(</span><span class="p">${</span><span class="nx">margin</span><span class="p">.</span><span class="nx">left</span><span class="p">}</span><span class="s2">,</span><span class="p">${</span><span class="nx">margin</span><span class="p">.</span><span class="nx">top</span><span class="p">}</span><span class="s2">)`</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">linesContainer</span> <span class="o">=</span> <span class="nx">g1</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">g</span><span class="dl">'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">transform</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`translate(0,</span><span class="p">${</span><span class="nx">margin</span><span class="p">.</span><span class="nx">top</span><span class="p">}</span><span class="s2">)`</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">barsContainer</span> <span class="o">=</span> <span class="nx">g1</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">g</span><span class="dl">'</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">transform</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`translate(0,</span><span class="p">${</span><span class="nx">margin</span><span class="p">.</span><span class="nx">top</span><span class="p">}</span><span class="s2">)`</span><span class="p">);</span>

  <span class="nx">g1</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">g</span><span class="dl">'</span><span class="p">).</span><span class="nx">call</span><span class="p">(</span><span class="nx">xAxis</span><span class="p">);</span>

  <span class="c1">// create axes</span>
  <span class="kd">const</span> <span class="nx">bars</span> <span class="o">=</span> <span class="nx">barsContainer</span>
    <span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">g</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">rectangleData</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">g</span><span class="dl">'</span><span class="p">);</span>

  <span class="c1">// add stuff to the SVG</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">showRelations</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">linesContainer</span>
      <span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">polyline</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">polylineData</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">polyline</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">none</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">stroke</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">color</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">points</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">points</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">bars</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">rect</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">rx</span><span class="dl">'</span><span class="p">,</span> <span class="nx">elementHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">ry</span><span class="dl">'</span><span class="p">,</span> <span class="nx">elementHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">x</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">x</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">y</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">width</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">height</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">#ddd</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">stroke</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">black</span><span class="dl">'</span><span class="p">);</span>

  <span class="nx">bars</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">text</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">black</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">font-family</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">sans-serif</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">x</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">labelX</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">y</span><span class="dl">'</span><span class="p">,</span> <span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">labelY</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">label</span><span class="p">);</span>

  <span class="nx">bars</span>
    <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">title</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">tooltip</span><span class="p">);</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">createGanttChart</span> <span class="o">=</span> <span class="p">(</span><span class="nx">placeholder</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="p">{</span> <span class="nx">elementHeight</span><span class="p">,</span> <span class="nx">sortMode</span><span class="p">,</span> <span class="nx">showRelations</span><span class="p">,</span> <span class="nx">svgOptions</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// prepare data</span>
  <span class="kd">const</span> <span class="nx">margin</span> <span class="o">=</span> <span class="p">(</span><span class="nx">svgOptions</span> <span class="o">&amp;&amp;</span> <span class="nx">svgOptions</span><span class="p">.</span><span class="nx">margin</span><span class="p">)</span> <span class="o">||</span> <span class="p">{</span>
    <span class="na">top</span><span class="p">:</span> <span class="nx">elementHeight</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
    <span class="na">left</span><span class="p">:</span> <span class="nx">elementHeight</span> <span class="o">*</span> <span class="mi">2</span>
  <span class="p">};</span>

  <span class="kd">const</span> <span class="nx">scaleWidth</span> <span class="o">=</span> <span class="p">((</span><span class="nx">svgOptions</span> <span class="o">&amp;&amp;</span> <span class="nx">svgOptions</span><span class="p">.</span><span class="nx">width</span><span class="p">)</span> <span class="o">||</span> <span class="mi">600</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">margin</span><span class="p">.</span><span class="nx">left</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">scaleHeight</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">((</span><span class="nx">svgOptions</span> <span class="o">&amp;&amp;</span> <span class="nx">svgOptions</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="o">||</span> <span class="mi">200</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">*</span> <span class="nx">elementHeight</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">margin</span><span class="p">.</span><span class="nx">top</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">svgWidth</span> <span class="o">=</span> <span class="nx">scaleWidth</span> <span class="o">+</span> <span class="p">(</span><span class="nx">margin</span><span class="p">.</span><span class="nx">left</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">svgHeight</span> <span class="o">=</span> <span class="nx">scaleHeight</span> <span class="o">+</span> <span class="p">(</span><span class="nx">margin</span><span class="p">.</span><span class="nx">top</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">fontSize</span> <span class="o">=</span> <span class="p">(</span><span class="nx">svgOptions</span> <span class="o">&amp;&amp;</span> <span class="nx">svgOptions</span><span class="p">.</span><span class="nx">fontSize</span><span class="p">)</span> <span class="o">||</span> <span class="mi">12</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">sortMode</span><span class="p">)</span> <span class="nx">sortMode</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">date</span><span class="dl">'</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">showRelations</span><span class="p">)</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">undefined</span><span class="dl">'</span><span class="p">)</span> <span class="nx">showRelations</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

  <span class="nx">data</span> <span class="o">=</span> <span class="nx">parseUserData</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span> <span class="c1">// transform raw user data to valid values</span>
  <span class="nx">data</span> <span class="o">=</span> <span class="nx">sortElements</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">sortMode</span><span class="p">);</span>

  <span class="kd">const</span> <span class="p">{</span> <span class="nx">minStartDate</span><span class="p">,</span> <span class="nx">maxEndDate</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">findDateBoundaries</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

  <span class="c1">// add some padding to axes</span>
  <span class="nx">minStartDate</span><span class="p">.</span><span class="nx">subtract</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="dl">'</span><span class="s1">days</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">maxEndDate</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="dl">'</span><span class="s1">days</span><span class="dl">'</span><span class="p">);</span>

  <span class="nx">createChartSVG</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">placeholder</span><span class="p">,</span> <span class="p">{</span> <span class="nx">svgWidth</span><span class="p">,</span> <span class="nx">svgHeight</span><span class="p">,</span> <span class="nx">scaleWidth</span><span class="p">,</span> <span class="nx">elementHeight</span><span class="p">,</span> <span class="nx">scaleHeight</span><span class="p">,</span> <span class="nx">fontSize</span><span class="p">,</span> <span class="nx">minStartDate</span><span class="p">,</span> <span class="nx">maxEndDate</span><span class="p">,</span> <span class="nx">margin</span><span class="p">,</span> <span class="nx">showRelations</span> <span class="p">});</span>
<span class="p">};</span>

<p>The data format is like follows</p>
<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">[{</span>
  <span class="na">startDate</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2017-02-27</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">endDate</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2017-03-04</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">label</span><span class="p">:</span> <span class="dl">'</span><span class="s1">milestone 01</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">m01</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">dependsOn</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">},</span> <span class="p">{</span>
  <span class="na">startDate</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2017-02-23</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">endDate</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2017-03-01</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">label</span><span class="p">:</span> <span class="dl">'</span><span class="s1">milestone 06</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">m06</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">dependsOn</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">m01</span><span class="dl">'</span><span class="p">]</span>
<span class="p">},</span> <span class="p">{</span>
  <span class="na">duration</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="dl">'</span><span class="s1">days</span><span class="dl">'</span><span class="p">],</span>
  <span class="na">endDate</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2017-03-24</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">label</span><span class="p">:</span> <span class="dl">'</span><span class="s1">milestone 02</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">m02</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">dependsOn</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">m04</span><span class="dl">'</span><span class="p">]</span>
<span class="p">},</span> <span class="p">{</span>
  <span class="na">startDate</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2017-02-27</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">duration</span><span class="p">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="dl">'</span><span class="s1">days</span><span class="dl">'</span><span class="p">],</span>
  <span class="na">label</span><span class="p">:</span> <span class="dl">'</span><span class="s1">milestone 03</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">m03</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">dependsOn</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">m01</span><span class="dl">'</span><span class="p">]</span>
<span class="p">},</span> <span class="p">{</span>
  <span class="na">endDate</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2017-03-17</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">duration</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="dl">'</span><span class="s1">days</span><span class="dl">'</span><span class="p">],</span>
  <span class="na">label</span><span class="p">:</span> <span class="dl">'</span><span class="s1">milestone 04</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">m04</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">dependsOn</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">m01</span><span class="dl">'</span><span class="p">]</span>
<span class="p">}];</span>

<p>To create a chard on a page, you need to pass the reference to a valid existing DOM element where you want the diagram to appear, the data and the SVG options. These options define the looks of a chart - width, height of an element (rectangle), font size and so on. One more option is</p>
<span class="nx">createGanttChart</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">body</span><span class="dl">'</span><span class="p">),</span> <span class="nx">data</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">elementHeight</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
  <span class="na">sortMode</span><span class="p">:</span> <span class="dl">'</span><span class="s1">date</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// alternatively, 'childrenCount'</span>
  <span class="na">svgOptions</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">width</span><span class="p">:</span> <span class="mi">1200</span><span class="p">,</span>
    <span class="na">height</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span>
    <span class="na">fontSize</span><span class="p">:</span> <span class="mi">12</span>
  <span class="p">}</span>
<span class="p">});</span>
