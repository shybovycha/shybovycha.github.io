<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.0.3"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://shybovycha.github.io/2023/01/31/2023-01-31-how-not-to-use-monads.html/"><!-- Primary Meta Tags --><title>How not to use monads</title><meta name="title" content="How not to use monads"><meta name="description"><link rel="stylesheet" href="/_astro/index.BvFNhZYw.css">
<style>footer[data-astro-cid-sz7xmlte]{padding:2em 1em 6em;background:linear-gradient(var(--gray-gradient)) no-repeat;color:rgb(var(--gray));text-align:center}.social-links[data-astro-cid-sz7xmlte]{display:flex;justify-content:center;gap:1em;margin-top:1em}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]{text-decoration:none;color:rgb(var(--gray))}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]:hover{color:rgb(var(--gray-dark))}main[data-astro-cid-bvzihdzo]{width:calc(100% - 2em);max-width:100%;margin:0}.hero-image[data-astro-cid-bvzihdzo]{width:100%}.hero-image[data-astro-cid-bvzihdzo] img[data-astro-cid-bvzihdzo]{display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.prose[data-astro-cid-bvzihdzo]{width:720px;max-width:calc(100% - 2em);margin:auto;padding:1em;color:rgb(var(--gray-dark))}.title[data-astro-cid-bvzihdzo]{margin-bottom:1em;padding:1em 0;text-align:center;line-height:1}.title[data-astro-cid-bvzihdzo] h1[data-astro-cid-bvzihdzo]{margin:0 0 .5em}.date[data-astro-cid-bvzihdzo]{margin-bottom:.5em;color:rgb(var(--gray))}.last-updated-on[data-astro-cid-bvzihdzo]{font-style:italic}
[data-astro-image]{width:100%;height:auto;object-fit:var(--fit);object-position:var(--pos);aspect-ratio:var(--w) / var(--h)}[data-astro-image=responsive]{max-width:calc(var(--w) * 1px);max-height:calc(var(--h) * 1px)}[data-astro-image=fixed]{width:calc(var(--w) * 1px);height:calc(var(--h) * 1px)}
</style></head> <body data-astro-cid-bvzihdzo> <nav class="top"> <div class="links"> <a class="nav-link nav-item" href="/">Home</a> <a class="nav-link nav-item" href="/about.html">About</a> </div> </nav> <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="hero-image" data-astro-cid-bvzihdzo>  </div> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2023-01-31T00:23:24.000Z"> Jan 31, 2023 </time>  </div> <h1 data-astro-cid-bvzihdzo>How not to use monads</h1> <hr data-astro-cid-bvzihdzo> </div>  <p>Recently I have watched a video titled <a href="https://www.youtube.com/watch?v=c_F1o_so2MQ">“Optionals and errors in Haskell &#x26; Rust - monads by example”</a>.
In the video, the author makes a simple application simulating the retrieval of a HTML document via URL and checking
if the document contains the title. This is a half-simulated experience, aimed at the beginners to demonstrate how the error
handling is done in Rust and Haskell.</p>
<p>However, author in his code has made quite a few bad decisions.
And that’s what I want to make a focus of this blog: how one should <strong>not</strong> use monads and handle errors in Haskell.</p>
<p>Author’s original source looks like this:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="hs"><code><span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{-# </span><span style="color:#D73A49;--shiki-dark:#F97583">LANGUAGE</span><span style="color:#D73A49;--shiki-dark:#F97583"> DuplicateRecordFields</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> #-}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{-# </span><span style="color:#D73A49;--shiki-dark:#F97583">LANGUAGE</span><span style="color:#D73A49;--shiki-dark:#F97583"> MultiWayIf</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> #-}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{-# </span><span style="color:#D73A49;--shiki-dark:#F97583">LANGUAGE</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> OverloadedRecordDot #-}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{-# </span><span style="color:#D73A49;--shiki-dark:#F97583">LANGUAGE</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> OverloadedRecordUpdate #-}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Control.Monad</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">forM_</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Data.List</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">isInfixOf</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Data.Maybe</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">fromMaybe</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Text.Printf</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">printf</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">data</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Error</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">String</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">deriving</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Show</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">data</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {head </span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">data</span><span style="color:#D73A49;--shiki-dark:#F97583"> Head</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">data</span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  { title </span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    ok </span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  deriving</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Show</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readDoc</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readDoc url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  if</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">      |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"fail"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Left</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Bad read of %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">      |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> otherwise </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">          Right</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">            if</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">                |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"head-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">                |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">                    Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">                |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-empty"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">                    Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> ""</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">                |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> otherwise </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">                    Doc</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">                      { head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">                          Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Title of %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">                      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">buildSummary</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">buildSummary doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">  Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">head </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title), ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> True</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readAndBuildSummary</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readAndBuildSummary url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> case</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url </span><span style="color:#D73A49;--shiki-dark:#F97583">of</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">  Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> False</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">  Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buildSummary doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">isTitleNonEmpty</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">isTitleNonEmpty doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  head </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">head</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  title </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> head</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> not </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> null title</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">isTitleNonEmpty'</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">isTitleNonEmpty' doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> not </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;$></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> null </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;$></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (doc</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">head </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">isTitleNonEmpty''</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">isTitleNonEmpty'' doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> not </span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> null </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;$></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (doc</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">head </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readWhetherTitleNonEmpty</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readWhetherTitleNonEmpty url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  doc </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isTitleNonEmpty doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readWhetherTitleNonEmpty'</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readWhetherTitleNonEmpty' url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isTitleNonEmpty </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;$></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">main</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> ()</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">main </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> urls </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"good"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-empty"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"head-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"fail"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  forM_ urls </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#D73A49;--shiki-dark:#F97583"> \</span><span style="color:#24292E;--shiki-dark:#E1E4E8">url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Checking </span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">https://%s/</span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">:"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    -- Summary.</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> summary </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readAndBuildSummary url</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Summary: %s"</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> show summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Title: %s"</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fromMaybe </span><span style="color:#032F62;--shiki-dark:#9ECBFF">""</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> summary</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    -- Has title.</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hasTitle </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readWhetherTitleNonEmpty url</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    -- let hasTitleSure = either (const False) id $ fromMaybe False &#x3C;$> hasTitle</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hasTitleSure </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fromMaybe </span><span style="color:#005CC5;--shiki-dark:#79B8FF">False</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> either (const </span><span style="color:#005CC5;--shiki-dark:#79B8FF">Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) id hasTitle</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">      printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Has title: %s vs %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (show hasTitle) (show hasTitleSure)</span></span>
<span class="line"></span></code></pre>
<p>He then proceeded to wrapping this code in <code>IO</code> monad and ended up with the following:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="hs"><code><span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{-# </span><span style="color:#D73A49;--shiki-dark:#F97583">LANGUAGE</span><span style="color:#D73A49;--shiki-dark:#F97583"> DuplicateRecordFields</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> #-}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{-# </span><span style="color:#D73A49;--shiki-dark:#F97583">LANGUAGE</span><span style="color:#D73A49;--shiki-dark:#F97583"> LambdaCase</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> #-}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{-# </span><span style="color:#D73A49;--shiki-dark:#F97583">LANGUAGE</span><span style="color:#D73A49;--shiki-dark:#F97583"> MultiWayIf</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> #-}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{-# </span><span style="color:#D73A49;--shiki-dark:#F97583">LANGUAGE</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> OverloadedRecordDot #-}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{-# </span><span style="color:#D73A49;--shiki-dark:#F97583">LANGUAGE</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> OverloadedRecordUpdate #-}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Control.Monad</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">forM_</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Data.Functor</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> ((</span><span style="color:#6F42C1;--shiki-dark:#B392F0">&#x3C;&#x26;></span><span style="color:#24292E;--shiki-dark:#E1E4E8">))</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Data.List</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">isInfixOf</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Data.Maybe</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">fromMaybe</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Text.Printf</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">printf</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">data</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Error</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">String</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">deriving</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Show</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">data</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {head </span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">data</span><span style="color:#D73A49;--shiki-dark:#F97583"> Head</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">data</span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  { title </span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    ok </span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  deriving</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Show</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- readDoc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readDoc</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readDoc url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  return</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    if</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"fail"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Left</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Bad read of %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> otherwise </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">            Right</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">              if</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">                  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"head-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">                  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">                      Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">                  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-empty"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">                      Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> ""</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">                  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> otherwise </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">                      Doc</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">                        { head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">                            Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Title of %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">                        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- buildSummary</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">buildSummary</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">buildSummary doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">  Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">head </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title), ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> True</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- readAndBuildSummary</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readAndBuildSummary</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readAndBuildSummary url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#D73A49;--shiki-dark:#F97583"> case</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">of</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> False</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buildSummary doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readAndBuildSummary'</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readAndBuildSummary' url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  readDoc url </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#D73A49;--shiki-dark:#F97583"> \</span><span style="color:#24292E;--shiki-dark:#E1E4E8">docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#D73A49;--shiki-dark:#F97583"> case</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">of</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> True</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buildSummary doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readAndBuildSummary''</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readAndBuildSummary'' url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  readDoc url </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x26;></span><span style="color:#D73A49;--shiki-dark:#F97583"> \case</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> True</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buildSummary doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- isTitleNonEmpty</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">isTitleNonEmpty</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">isTitleNonEmpty doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  head </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">head</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  title </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> head</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> not </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> null title</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">isTitleNonEmpty'</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">isTitleNonEmpty' doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> not </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;$></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> null </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;$></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (doc</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">head </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">isTitleNonEmpty''</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">isTitleNonEmpty'' doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> not </span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> null </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;$></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (doc</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">head </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- readWhetherTitleNonEmpty</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readWhetherTitleNonEmpty</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span><span style="color:#24292E;--shiki-dark:#E1E4E8">))</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readWhetherTitleNonEmpty url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    doc </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isTitleNonEmpty doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readWhetherTitleNonEmpty'</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span><span style="color:#24292E;--shiki-dark:#E1E4E8">))</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readWhetherTitleNonEmpty' url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  readDoc url </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#D73A49;--shiki-dark:#F97583"> \</span><span style="color:#24292E;--shiki-dark:#E1E4E8">docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#D73A49;--shiki-dark:#F97583"> \</span><span style="color:#24292E;--shiki-dark:#E1E4E8">doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isTitleNonEmpty doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readWhetherTitleNonEmpty''</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span><span style="color:#24292E;--shiki-dark:#E1E4E8">))</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readWhetherTitleNonEmpty'' url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (isTitleNonEmpty </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;$></span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;$></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readWhetherTitleNonEmpty'''</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span><span style="color:#24292E;--shiki-dark:#E1E4E8">))</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readWhetherTitleNonEmpty''' url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x26;></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;&#x26;></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isTitleNonEmpty)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- main</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">main</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> ()</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">main </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> urls </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"good"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-empty"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"head-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"fail"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  forM_ urls </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#D73A49;--shiki-dark:#F97583"> \</span><span style="color:#24292E;--shiki-dark:#E1E4E8">url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Checking </span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">https://%s/</span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">:"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    -- Summary.</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    summary </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readAndBuildSummary url</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Summary: %s"</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> show summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Title: %s"</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fromMaybe </span><span style="color:#032F62;--shiki-dark:#9ECBFF">""</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> summary</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    -- Has title.</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    hasTitle </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readWhetherTitleNonEmpty url</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    -- let hasTitleSure = either (const False) id $ fromMaybe False &#x3C;$> hasTitle</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hasTitleSure </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fromMaybe </span><span style="color:#005CC5;--shiki-dark:#79B8FF">False</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> either (const </span><span style="color:#005CC5;--shiki-dark:#79B8FF">Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) id hasTitle</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">      printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Has title: %s vs %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (show hasTitle) (show hasTitleSure)</span></span>
<span class="line"></span></code></pre>
<p>I see a few issues with this code:</p>
<ol>
<li>the abuse of <code>IO</code> monad</li>
<li>the excessive (an I mean unnecessary) use of <code>Maybe</code> monad</li>
<li>too many unnecessary <code>readDoc</code> calls (bear in mind: it is supposed to be a network call + document parse, so quite a heavy function)</li>
</ol>
<h2 id="improvements">Improvements</h2>
<p>My suggestions on how to make their code better:</p>
<ol>
<li>only stick to <code>IO</code> where the function is actually interacting with the external world;
in this case this would be either <code>main</code> or <code>readDoc</code> (when it actually makes a network call)</li>
<li>eliminate the abuse of <code>Maybe Bool</code> - in the functions where the <code>Maybe Bool</code> is used (<code>isTitleNonEmpty</code> and its variations)
just <code>Bool</code> would suffice</li>
<li>only call <code>readDoc</code> once and use the result down the pipeline, no need to call it multiple times
(<code>readAndBuildSummary</code>, <code>readWhetherTitleNonEmpty</code>)</li>
<li>reduce the nested <code>if</code> statements to guard expressions</li>
<li>replace the <code>case eitherValue</code> expressions with the <code>either</code> function</li>
<li>remove the dead / unused / unnecessary code
(like those duplicated functions - <code>readWhetherTitleNonEmpty'</code>, <code>readWhetherTitleNonEmpty''</code> and <code>readWhetherTitleNonEmpty'''</code>)</li>
</ol>
<h3 id="use-io-monad-only-for-the-functions-which-interact-with-the-outside-world">Use <code>IO</code> monad only for the functions which interact with the outside world</h3>
<p><code>IO</code> monad tells compiler and the people who read the code the function operates outside of the program internals.
Like actually performing input-output, working with network, operating system, etc.</p>
<p>You can think of any such function as an unsafe part of an application.</p>
<p>In the example above, most of the functions do not comply with that - they are simply a side-effect of poor monad operations
and could be easily changed as follows:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="hs"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">isTitleNonEmpty</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">isTitleNonEmpty doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  head </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">head</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  title </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> head</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> not </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> null title</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">buildSummary</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">buildSummary doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">  Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">head </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title), ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> True</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- there is absolutely no need for this function</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readWhetherTitleNonEmpty</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span><span style="color:#24292E;--shiki-dark:#E1E4E8">))</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readWhetherTitleNonEmpty url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    doc </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isTitleNonEmpty doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- this is also redundant</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readAndBuildSummary</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readAndBuildSummary url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#D73A49;--shiki-dark:#F97583"> case</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">of</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> False</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buildSummary doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- this is the (reduced) existing code</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">main__old</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> ()</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">main__old </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "good"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Checking </span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">https://%s/</span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">:"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  summary </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readAndBuildSummary url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Summary: %s"</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> show summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Title: %s"</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fromMaybe </span><span style="color:#032F62;--shiki-dark:#9ECBFF">""</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> summary</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  hasTitle </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readWhetherTitleNonEmpty url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- note how the document is only passed down to the functions which actually operate on the document</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- the only two functions using `IO` monad here are `main` and `readDoc`, as both perform input-output operations</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">main</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> ()</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">main </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "good"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Checking </span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">https://%s/</span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">:"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> summary </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> case</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">of</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> False</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buildSummary doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Summary: %s"</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> show summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Title: %s"</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fromMaybe </span><span style="color:#032F62;--shiki-dark:#9ECBFF">""</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> summary</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hasTitle </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isTitleNonEmpty doc</span></span>
<span class="line"></span></code></pre>
<h3 id="reduce-calls-to-io-functions">Reduce calls to <code>IO</code> functions</h3>
<div class="content-read-marker" data-fraction="50"></div>
<p>Pure functions must return the exact same value for the same arguments, regardless of how many times they are called.</p>
<p><code>IO</code> (and a lot of other monads, like <code>Reader</code>, <code>Writer</code>, etc.) work around this rule by changing the outside world.
So even though a function <em>technically</em> returns the same <em>value</em> every time, the side-effect of an <code>IO</code> monad can
potentially change something elsewhere, outside of the function itself.</p>
<p>This makes the programs non-pure and might cause a lot of negative impact. These side effects are what is thought to be
the root of all evils in (functional) programming. They make it hard to figure out what a program actually does.
They make the functions and programs hard to test and prove to be correct.</p>
<p>From the performance perspective, if a function actually does change the outside world, it can’t be memoized and
it won’t be optimized by the compiler to only use its result, computed once.</p>
<p>Think calling a function which tries to create a user in a system or drop a database table. This would happen on every call.
If you call such function twice, it will most likely fail (due to database failures, hopefully).</p>
<p>But what if the function <em>creates</em> data instead and there are no checks for duplicates in the external system?
Like appending a log line. If such function was to be called multiple times, it can quickly bloat the storage.
This is a potential security issue as well.</p>
<p>So instead of calling such functions (recap: functions returning <code>IO</code> monad), why not call them once and store the result?
Then the entire program can operate on the stored result value.</p>
<p>Of course, there are plethora of cases where such behaviour (calling such functions multiple times) is actually desired.
But in the sample code from above, this is not the case.</p>
<p>Check the transformed code from the previous point how this solution is utilized:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="hs"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">main</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> ()</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">main </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "good"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Checking </span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">https://%s/</span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">:"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">  -- store the result of fetching a document by its URL</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">  -- work on the stored value instead of sending an extra HTTP request</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> summary </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> case</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">of</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> False</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buildSummary doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Summary: %s"</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> show summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Title: %s"</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fromMaybe </span><span style="color:#032F62;--shiki-dark:#9ECBFF">""</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> summary</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">  -- work on the stored value again, preventing one more HTTP request</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hasTitle </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> case</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">of</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> False</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isTitleNonEmpty doc</span></span>
<span class="line"></span></code></pre>
<h3 id="eliminate-the-abuse-of-maybe-bool">Eliminate the abuse of <code>Maybe Bool</code></h3>
<p>There’s simply no need to go overboard with <code>Maybe</code> in methods which simply check whether something is present or not.</p>
<p><code>Maybe Bool</code> introduces a tri-state:</p>
<ul>
<li><code>Just False</code></li>
<li><code>Just True</code></li>
<li><code>Nothing</code></li>
</ul>
<p>In cases where this is desired, is much better to represent each of the state with a semantic value:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="hs"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">type</span><span style="color:#D73A49;--shiki-dark:#F97583"> HeaderPresence</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#D73A49;--shiki-dark:#F97583"> NoHeader</span><span style="color:#D73A49;--shiki-dark:#F97583"> |</span><span style="color:#D73A49;--shiki-dark:#F97583"> EmptyHeader</span><span style="color:#D73A49;--shiki-dark:#F97583"> |</span><span style="color:#D73A49;--shiki-dark:#F97583"> HasHeader</span></span>
<span class="line"></span></code></pre>
<p>This way the code is much easier to follow and debug.</p>
<p>For the sample in question even this approach is redundant - the function simply checks whether the value (title) is present or not,
so a simple <code>Bool</code> would suffice:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="hs"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">isTitleNonEmpty__old</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">isTitleNonEmpty__old doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  head </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">head</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  title </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> head</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> not </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> null title</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">isTitleNonEmpty</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">isTitleNonEmpty doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  not </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> null title</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  where</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">head doc </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> head</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">title</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">main__old</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> ()</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">main__old </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "good"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  hasTitle </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#D73A49;--shiki-dark:#F97583"> case</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">of</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> None</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isTitleNonEmpty__old doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hasTitleSure </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fromMaybe </span><span style="color:#005CC5;--shiki-dark:#79B8FF">False</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> either (const </span><span style="color:#005CC5;--shiki-dark:#79B8FF">Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) id hasTitle</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Has title: %s vs %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (show hasTitle) (show hasTitleSure)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">main</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> ()</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">main </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "good"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Checking </span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">https://%s/</span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">:"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">  -- a simple True | False value, no need to mess with Maybe</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hasTitle </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> case</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">of</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> False</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isTitleNonEmpty doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">  -- note: no need to wrap &#x26; unwrap Maybe and Either</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Has title: %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (show hasTitle)</span></span>
<span class="line"></span></code></pre>
<h3 id="reduce-the-nested-if-statements---use-guard-expressions">Reduce the nested <code>if</code> statements - use guard expressions</h3>
<p>The original <code>readDoc</code> function uses a rather unnecessarily bulky <code>if</code> statement:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="hs"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readDoc</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readDoc url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  return</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    if</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"fail"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Left</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Bad read of %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> otherwise </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">            Right</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">              if</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">                  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"head-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">                  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">                      Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">                  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-empty"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">                      Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> ""</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">                  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> otherwise </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">                      Doc</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">                        { head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">                            Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Title of %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">                        }</span></span>
<span class="line"></span></code></pre>
<p>Haskell provides a built-in language feature for just this case, which really does make code cleaner a lot:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="hs"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readDoc</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readDoc url</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"fail"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Left</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Bad read of %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"head-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Right</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> { head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Right</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> { head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> { title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> } }</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isInfixOf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-empty"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Right</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> { head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> { title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> ""</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> } }</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> otherwise </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Right</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> { head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> { title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Title of %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url } }</span></span>
<span class="line"></span></code></pre>
<h3 id="use-existing-functions-on-monads-instead-of-case-statements">Use existing functions on monads instead of <code>case</code> statements</h3>
<p>In my experience, for the most part, you want to simply apply a function to a <code>Maybe</code> or an <code>Either</code>.</p>
<p>And, again, for the most part, you either ignore one of the states of the monad (be it <code>Nothing</code> or <code>Left</code>), or apply a different function to it.</p>
<p>There are handy helper functions for these situations which do make the code cleaner -
<a href="https://hackage.haskell.org/package/base-4.17.0.0/docs/src/Data.Maybe.html#fromMaybe"><code>fromMaybe</code></a> and
<a href="https://hackage.haskell.org/package/base-4.17.0.0/docs/src/Data.Either.html#either"><code>either</code></a>.</p>
<p>Consider few examples:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="hs"><code><span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">hasTitle__old </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#D73A49;--shiki-dark:#F97583"> case</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">of</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">  Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> None</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">  Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isTitleNonEmpty__old doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">hasTitle </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> either (const </span><span style="color:#005CC5;--shiki-dark:#79B8FF">None</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) (isTitleNonEmpty__old)</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="hs"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> summary__old </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> case</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">of</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">  Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> False</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">  Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> buildSummary doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- needs a nice helper function</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">invalid_summary </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> { title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> False</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> summary </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> either invalid_summary buildSummary</span></span>
<span class="line"></span></code></pre>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="hs"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hasTitle__old </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> case</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">of</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">  Left</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> err </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#005CC5;--shiki-dark:#79B8FF"> False</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">  Right</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> doc </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#24292E;--shiki-dark:#E1E4E8"> isTitleNonEmpty doc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hasTitle </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> either (const </span><span style="color:#005CC5;--shiki-dark:#79B8FF">False</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) isTitleNonEmpty</span></span>
<span class="line"></span></code></pre>
<h2 id="end-result">End result</h2>
<p>Here’s what the code looks like when applying all of the above suggestions and tidying up the code:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="hs"><code><span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">{-# </span><span style="color:#D73A49;--shiki-dark:#F97583">LANGUAGE</span><span style="color:#D73A49;--shiki-dark:#F97583"> DuplicateRecordFields</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> #-}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Control.Monad</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">forM_</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Data.List</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">isInfixOf</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Data.Maybe</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">fromMaybe</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Text.Printf</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#6F42C1;--shiki-dark:#B392F0">printf</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">newtype</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> deriving</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Show</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">newtype</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {_head </span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">newtype</span><span style="color:#D73A49;--shiki-dark:#F97583"> Head</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">data</span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span><span style="color:#D73A49;--shiki-dark:#F97583"> =</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  { title </span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    ok </span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  deriving</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Show</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- helpers for Repl.It is meh with language extensions</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">docHead</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> Head</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">docHead </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> _head</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">headTitle</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Head</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">headTitle </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> title</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">summaryTitle</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Maybe</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">summaryTitle </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> title</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- implementations</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readDoc</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="color:#D73A49;--shiki-dark:#F97583">Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readDoc url</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  |</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "fail"</span><span style="color:#D73A49;--shiki-dark:#F97583"> `isInfixOf`</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Left</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Bad read of %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  |</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "head-missing"</span><span style="color:#D73A49;--shiki-dark:#F97583"> `isInfixOf`</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Right</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {_head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  |</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "title-missing"</span><span style="color:#D73A49;--shiki-dark:#F97583"> `isInfixOf`</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Right</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {_head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  |</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "title-empty"</span><span style="color:#D73A49;--shiki-dark:#F97583"> `isInfixOf`</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Right</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {_head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> ""</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}}</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  |</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> otherwise </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> return </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Right</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Doc</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {_head </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Head</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Just</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Title of %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url}}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">buildSummary</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">buildSummary doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">  Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docHead doc </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> headTitle, ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> True</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">invalidSummary</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">invalidSummary </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Summary</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Nothing</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, ok </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> False</span><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readAndBuildSummary</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readAndBuildSummary </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> either invalidSummary buildSummary</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readAndBuildTitle</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Summary</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> String</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readAndBuildTitle summary </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> fromMaybe </span><span style="color:#032F62;--shiki-dark:#9ECBFF">""</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (summaryTitle summary)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">isTitleNonEmpty</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">isTitleNonEmpty doc </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  not </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> null title</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  where</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> docHead doc </span><span style="color:#D73A49;--shiki-dark:#F97583">>>=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> headTitle</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">readWhetherTitleNonEmpty</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> Either</span><span style="color:#D73A49;--shiki-dark:#F97583"> Error</span><span style="color:#D73A49;--shiki-dark:#F97583"> Doc</span><span style="color:#D73A49;--shiki-dark:#F97583"> -></span><span style="color:#D73A49;--shiki-dark:#F97583"> Bool</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">readWhetherTitleNonEmpty </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> either (const </span><span style="color:#005CC5;--shiki-dark:#79B8FF">False</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) isTitleNonEmpty</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">-- main</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">main</span><span style="color:#D73A49;--shiki-dark:#F97583"> ::</span><span style="color:#D73A49;--shiki-dark:#F97583"> IO</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> ()</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">main </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> urls </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"good"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-empty"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"title-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"head-missing"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"fail"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  forM_ urls </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#D73A49;--shiki-dark:#F97583"> \</span><span style="color:#24292E;--shiki-dark:#E1E4E8">url </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Checking </span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">https://%s/</span><span style="color:#005CC5;--shiki-dark:#79B8FF">\"</span><span style="color:#032F62;--shiki-dark:#9ECBFF">:"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    docOrError </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readDoc url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    -- Summary</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> summary </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readAndBuildSummary docOrError</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> title </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readAndBuildTitle summary</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Summary: %s"</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> show summary</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Title: %s"</span><span style="color:#D73A49;--shiki-dark:#F97583"> $</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> title</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    -- Has title</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> hasTitle </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> readWhetherTitleNonEmpty docOrError</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    putStrLn </span><span style="color:#D73A49;--shiki-dark:#F97583">$</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> printf </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"  Has title: %s"</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> (show hasTitle)</span></span>
<span class="line"></span></code></pre>
<div class="content-read-marker" data-fraction="100"></div>  </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2024 Your name here. All rights reserved.
<div class="social-links" data-astro-cid-sz7xmlte> <a href="https://m.webtoo.ls/@astro" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Follow Astro on Mastodon</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/mastodon" data-astro-cid-sz7xmlte><path fill="currentColor" d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a3.614 3.614 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522c0-.859.22-1.541.66-2.046.456-.505 1.052-.764 1.793-.764.856 0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764.442.505.661 1.187.661 2.046v4.203z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://twitter.com/astrodotbuild" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Follow Astro on Twitter</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/twitter" data-astro-cid-sz7xmlte><path fill="currentColor" d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://github.com/withastro/astro" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Go to Astro's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/github" data-astro-cid-sz7xmlte><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg> </a> </div> </footer>  </body></html>