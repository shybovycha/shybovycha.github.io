<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.0.3"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://shybovycha.github.io/page9.html/"><!-- Primary Meta Tags --><title>moofoo blog</title><meta name="title" content="moofoo blog"><meta name="description" content="Welcome to my website!"><link rel="stylesheet" href="/_astro/index.BvFNhZYw.css">
<style>[data-astro-image]{width:100%;height:auto;object-fit:var(--fit);object-position:var(--pos);aspect-ratio:var(--w) / var(--h)}[data-astro-image=responsive]{max-width:calc(var(--w) * 1px);max-height:calc(var(--h) * 1px)}[data-astro-image=fixed]{width:calc(var(--w) * 1px);height:calc(var(--h) * 1px)}
</style></head> <body> <nav class="top"> <div class="links"> <a class="nav-link nav-item" href="/">Home</a> <a class="nav-link nav-item" href="/about.html">About</a> </div> </nav> <main> <section> <article> <h1> <a href="/2015/03/24/2015-03-24-decorator-pattern-in-python.html">Decorator pattern in Python</a> </h1> <time datetime="2015-03-24T09:41:35.000Z"> Mar 24, 2015 </time> <div class="content"> <p>Just found some interesting way of implementing Decorator design pattern in Python.</p>
<p>As <strong>Jason Smith</strong> said in his book (<strong>Elemental Design Patterns</strong>), <em>“design patterns may be implemened in different ways in different programming languages”</em>.</p>
<p>That’s said, design patterns are not some set of classes which will be implemented in a very similar way in different languages - they are just a way of doing something.</p>
<p>Thus, Decorator pattern is a way of wrapping some method’s or class’ behaviour. In Python it may be done with <strong>Context Managers:</strong></p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">from</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> contextlib </span><span style="color:#D73A49;--shiki-dark:#F97583">import</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> contextmanager</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">@contextmanager</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> tag</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(name):</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    print</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "&#x3C;</span><span style="color:#005CC5;--shiki-dark:#79B8FF">%s</span><span style="color:#032F62;--shiki-dark:#9ECBFF">>"</span><span style="color:#D73A49;--shiki-dark:#F97583"> %</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> name,</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    yield</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    print</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "&#x3C;/</span><span style="color:#005CC5;--shiki-dark:#79B8FF">%s</span><span style="color:#032F62;--shiki-dark:#9ECBFF">>"</span><span style="color:#D73A49;--shiki-dark:#F97583"> %</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> name,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">with</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> tag(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"h1"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">):</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    print</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "moo"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">print</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">with</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> tag(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"div"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">):</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    print</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "foo"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"></span></code></pre>
<p>This code will end up wrapping <code>print "foo"</code> and <code>print "moo"</code> methods with printing some HTML tags around ‘em:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="html"><code><span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#22863A;--shiki-dark:#85E89D">h1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">>moo&#x3C;/</span><span style="color:#22863A;--shiki-dark:#85E89D">h1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">></span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#22863A;--shiki-dark:#85E89D">div</span><span style="color:#24292E;--shiki-dark:#E1E4E8">>foo&#x3C;/</span><span style="color:#22863A;--shiki-dark:#85E89D">div</span><span style="color:#24292E;--shiki-dark:#E1E4E8">></span></span>
<span class="line"></span></code></pre>
<p>That is interesting as it implements Decorator design pattern in a bit hard-coded way, but using language features, not OOP ones.</p>
<p>Compare it to the <em>"standard"</em> OOP implementation in Python:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D"># -*-coding:utf-8 -*-</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">class</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> SimpleText</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">object</span><span style="color:#24292E;--shiki-dark:#E1E4E8">):</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    def</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> __init__</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(self, text):</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">        self</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.text </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> text</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> content</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(self):</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        return</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> self</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.text</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    def</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> __str__</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(self):</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        return</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> self</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.content()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">class</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> TagDecorator</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#6F42C1;--shiki-dark:#B392F0">SimpleText</span><span style="color:#24292E;--shiki-dark:#E1E4E8">):</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    def</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> __init__</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(self, text, tag):</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">        super</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(TagDecorator, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">self</span><span style="color:#24292E;--shiki-dark:#E1E4E8">).</span><span style="color:#005CC5;--shiki-dark:#79B8FF">__init__</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(text)</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">        self</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.tag </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> tag</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> content</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(self):</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        return</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> '&#x3C;</span><span style="color:#005CC5;--shiki-dark:#79B8FF">{0}</span><span style="color:#032F62;--shiki-dark:#9ECBFF">></span><span style="color:#005CC5;--shiki-dark:#79B8FF">{1}</span><span style="color:#032F62;--shiki-dark:#9ECBFF">&#x3C;/</span><span style="color:#005CC5;--shiki-dark:#79B8FF">{0}</span><span style="color:#032F62;--shiki-dark:#9ECBFF">>'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.format(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">self</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.tag, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">super</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(TagDecorator, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">self</span><span style="color:#24292E;--shiki-dark:#E1E4E8">).content())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">a </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> SimpleText(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'moo'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'SimpleText: </span><span style="color:#005CC5;--shiki-dark:#79B8FF">%s</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'</span><span style="color:#D73A49;--shiki-dark:#F97583"> %</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> a)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">b </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> TagDecorator(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'moo'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#032F62;--shiki-dark:#9ECBFF">'h1'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">print</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'TagDecorator (h1): </span><span style="color:#005CC5;--shiki-dark:#79B8FF">%s</span><span style="color:#032F62;--shiki-dark:#9ECBFF">'</span><span style="color:#D73A49;--shiki-dark:#F97583"> %</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> b)</span></span>
<span class="line"></span></code></pre>
<p>This one looks a bit… ugly… right? And though Python does not really care of which type are <code>a</code> and <code>b</code>, we may not need all this class hierarchy.</p>
<p>This is the might of <strong>context managers</strong>!</p> </div>  </article><article> <h1> <a href="/2015/03/24/2015-03-24-how-to-adjust-widget-size-in-qt.html">How to adjust widget’ size in Qt</a> </h1> <time datetime="2015-03-24T07:56:37.000Z"> Mar 24, 2015 </time> <div class="content"> <p>Have you ever thought on how this:</p>
<p></p><figure data-orig-height="368" data-orig-width="734"><img src="/images/tumblr/qt_adjust_widget/tumblr_inline_nlphu7Lp7Q1qh5oee_500.webp" data-orig-height="368" data-orig-width="734"></figure><p></p>
<p>could be turned to this:</p>
<p></p><figure data-orig-height="369" data-orig-width="730"><img src="/images/tumblr/qt_adjust_widget/tumblr_inline_nlphuiqjyZ1qh5oee_500.webp" data-orig-height="369" data-orig-width="730"></figure><p></p>
<p>without manually setting per-pixel sizes?</p>
<p>It’s simple as 1-2! Just take a look at the top of the UI editor and you’ll find a set of buttons, dedicated to do this adjustment for you:</p>
<p></p><figure data-orig-height="737" data-orig-width="1366"><img src="/images/tumblr/qt_adjust_widget/tumblr_inline_nlpi06oySm1qh5oee_500.webp" data-orig-height="737" data-orig-width="1366"></figure><p></p>
<p>Yet, there is just one small tip: first you should select a containing widget, whose children will be rearranged.</p>
<p>Like this:</p>
<p></p><figure data-orig-height="737" data-orig-width="1366"><img src="/images/tumblr/qt_adjust_widget/tumblr_inline_nlpi0pvXoe1qh5oee_500.webp" data-orig-height="737" data-orig-width="1366"></figure><p></p>
<p>Note the selected parent widget for <i>vertical_layout.</i></p> </div>  </article><article> <h1> <a href="/2015/03/12/2015-03-12-how-did-i-came-over-from-that-to-this.html">Modelling in Blender</a> </h1> <time datetime="2015-03-12T08:45:09.000Z"> Mar 12, 2015 </time> <div class="content"> <img src="/tumblr_files/tumblr_nl3cb9Adqo1qio88bo1_1280.png" loading="lazy">
<p>How did I came over from that to this…</p>
<img src="/tumblr_files/tumblr_nl3cb9Adqo1qio88bo2_1280.png" loading="lazy">
<p>NB: this is a 3D model potentially to be used in my ShootThem! game. Inspired by the Chicken Hat from Fable:</p>
<img src="/images/tumblr/chicken_head/Chicken_Hat.webp" loading="lazy" alt="Chicken Hat from Fable"> </div>  </article><article> <h1> <a href="/2015/03/05/2015-03-04-reworked-materials-for-my-rifle.html">reworked materials for my rifle</a> </h1> <time datetime="2015-03-04T20:32:14.000Z"> Mar 5, 2015 </time> <div class="content"> <img src="/tumblr_files/tumblr_nkpfpqQNbY1qio88bo1_r1_1280.png" loading="lazy">
<p>Reworked materials for my rifle</p> </div>  </article><article> <h1> <a href="/2015/03/04/2015-03-04-creating-some-gun-from-a-rough-primitive-model.html">creating some gun from a rough primitive model</a> </h1> <time datetime="2015-03-04T09:21:38.000Z"> Mar 4, 2015 </time> <div class="content"> <img src="/tumblr_files/tumblr_nkoko2Ofx71qio88bo1_1280.png" alt="Textured rifle made in Blender">
<img src="/tumblr_files/tumblr_nkoko2Ofx71qio88bo2_1280.png" alt="Rifle model with few material properties and a bit of sculpting">
<p>Creating some gun from a rough primitive model with some texture and sculpting. Yet, trying to get some pretty materials on this…</p> </div>  </article><article> <h1> <a href="/2015/03/04/2015-03-04-have-had-some-free-time-and-tried-sculpting-in.html">Trying sculpting in Blender</a> </h1> <time datetime="2015-03-04T09:20:21.000Z"> Mar 4, 2015 </time> <div class="content"> <img src="/tumblr_files/tumblr_nkoklxttap1qio88bo1_1280.png" loading="lazy" alt="Chicken body sculpt in Blender">
<img src="/tumblr_files/tumblr_nkoklxttap1qio88bo2_1280.png" loading="lazy" alt="Chicken head in Blender">
<p>Have had some free time and tried sculpting in Blender 😜 With some other nice stuff 😁</p> </div>  </article><article> <h1> <a href="/2015/02/23/2015-02-23-having-fun-with-blender.html">Having fun with Blender</a> </h1> <time datetime="2015-02-23T11:40:15.000Z"> Feb 23, 2015 </time> <div class="content"> <img src="/tumblr_files/tumblr_nk8333m6vx1qio88bo1_1280.png" loading="lazy" alt="Having fun texturing chicken head in Blender">
<p>Just some WIP. Having fun with Blender 😊</p> </div>  </article><article> <h1> <a href="/2015/02/19/2015-02-19-installing-deb-package-with-dependencies.html">Installing deb package with dependencies</a> </h1> <time datetime="2015-02-19T09:54:53.000Z"> Feb 19, 2015 </time> <div class="content"> <p>Oftenly,</p>
<pre><code>sudo dpkg -i package_file.deb
</code></pre>
<p>fails with messages like <em>dependency not satisfied</em>.</p>
<p>To fix this, there are two ways:</p>
<ol><li><code>sudo dpkg -i package_file.deb &#x26;&#x26; sudo apt-get -f install</code></li>
<li><code>sudo dpkg -i --force-depends package_file.deb</code></li>
</ol><p>Obviously, the second one is shorter =)</p> </div>  </article><article> <h1> <a href="/2015/02/17/2015-02-17-my-very-first-model-in-blender.html">My very first model in Blender</a> </h1> <time datetime="2015-02-17T08:39:00.000Z"> Feb 17, 2015 </time> <div class="content"> <img src="/tumblr_files/tumblr_njwqqioF171qio88bo1_1280.png" alt="Cup modelled in Blender">
<img src="/tumblr_files/tumblr_njwqqioF171qio88bo2_r1_1280.png" alt="Textured cup in Blender">
<p>Playing around with Blender - rendering, modifiers and some basic texturing and materials.</p> </div>  </article><article> <h1> <a href="/2015/02/09/2015-02-09-rails-tips.html">Rails tips</a> </h1> <time datetime="2015-02-09T09:09:30.000Z"> Feb 9, 2015 </time> <div class="content"> <p>Found these on HabraHabr today. Here are some tricks I found usefull.</p>
<h2>Private methods are not actually private</h2>
<p>Let us have class:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">class</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Moo</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  private</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> self.foo</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    puts</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> 'foo'</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  end</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">end</span></span>
<span class="line"></span></code></pre>
<p>Here, class method <code>foo</code> is not private:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">Foo</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.foo</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">=> </span><span style="color:#032F62;--shiki-dark:#9ECBFF">'foo'</span></span>
<span class="line"></span></code></pre>
<h2>Instance with params</h2>
<p>Oftenly there is a need to create a class instance and set it some params (or, maybe, call some methods on it). It's done usually like this:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">moo </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Moo</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.</span><span style="color:#D73A49;--shiki-dark:#F97583">new</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">moo.foo </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> 'foo'</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">moo.bar</span></span>
<span class="line"></span></code></pre>
<p>This can be shortened with the use of `tap` method:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">moo </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Moo</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.</span><span style="color:#D73A49;--shiki-dark:#F97583">new</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.tap { |a| a.foo </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> 'foo'</span><span style="color:#24292E;--shiki-dark:#E1E4E8">; a.bar }</span></span>
<span class="line"></span></code></pre>
<p>Yet, it is more ruby-convenient and ruby-style to do it with the initialization block:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">class</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Moo</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  attr_accessor</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> :foo</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> initialize</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">block)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    yield</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> self</span><span style="color:#D73A49;--shiki-dark:#F97583"> if</span><span style="color:#D73A49;--shiki-dark:#F97583"> block_given?</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> bar</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    puts</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "bar!"</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  end</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">moo </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Moo</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.</span><span style="color:#D73A49;--shiki-dark:#F97583">new</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> |a|</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  a.foo </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> 'foo'</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  a.bar</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">puts</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> moo.foo</span></span>
<span class="line"></span></code></pre>
<p>Or even like this:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">class</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Moo</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> initialize</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">block)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    instance_eval </span><span style="color:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">block </span><span style="color:#D73A49;--shiki-dark:#F97583">if</span><span style="color:#D73A49;--shiki-dark:#F97583"> block_given?</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> moo</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(val </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> nil</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    @moo </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> val </span><span style="color:#D73A49;--shiki-dark:#F97583">unless</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> val.nil?</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    @moo</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> bar</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    puts</span><span style="color:#032F62;--shiki-dark:#9ECBFF"> "bar!"</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  end</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">a </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> Moo</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.</span><span style="color:#D73A49;--shiki-dark:#F97583">new</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  moo </span><span style="color:#032F62;--shiki-dark:#9ECBFF">'moo~!'</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">  bar</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">puts</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> a.moo</span></span>
<span class="line"></span></code></pre>
<h2>Code-dependent migrations</h2>
<p>When you have your migrations using your code, for example, like this:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">class</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> CreateDataVolumes</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x3C;</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> ActiveRecord::Migration</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> up</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Data</span><span style="color:#24292E;--shiki-dark:#E1E4E8">::</span><span style="color:#005CC5;--shiki-dark:#79B8FF">VOLUMES</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.times </span><span style="color:#D73A49;--shiki-dark:#F97583">do</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> |volume|</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">      create_table </span><span style="color:#032F62;--shiki-dark:#9ECBFF">"data_</span><span style="color:#032F62;--shiki-dark:#9ECBFF">#{volume}</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"</span><span style="color:#D73A49;--shiki-dark:#F97583"> do</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> |t|</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">        # ...</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">      end</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    end</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  end</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">end</span></span>
<span class="line"></span></code></pre>
<p>you then have a problem when updating your code. In our example, if you remove the constant <code>Data::VOLUMES</code>, you will have to either manually search for all the usages of this constant, or have a really <em>intelliJent</em> IDE ;)</p>
<p>Rather than using your existing code, stub it and copy-and-paste all migration-dependent code to the stubbing class:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ruby"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">class</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> CreateDataVolumes</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x3C;</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> ActiveRecord::Migration</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  class</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Data</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x3C;</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> AR::Base</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    VOLUMES</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  def</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> up</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">    Data</span><span style="color:#24292E;--shiki-dark:#E1E4E8">::</span><span style="color:#005CC5;--shiki-dark:#79B8FF">VOLUMES</span><span style="color:#24292E;--shiki-dark:#E1E4E8">.times </span><span style="color:#D73A49;--shiki-dark:#F97583">do</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> |volume|</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">      # ...</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    end</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">  end</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">end</span></span>
<span class="line"></span></code></pre>
<p>Example with constant is rather stupid, whilst you may have some more critical code.</p> </div>  </article> </section> </main> <footer> <nav> <div class="prev"> <a href="/page8.html" class="next">&larr; Previous page</a> </div> <div class="current">Page #9 of 11</div> <div class="next"> <a href="/page10.html" class="next">Next page &rarr;</a> </div> </nav> </footer> </body></html>